TCP（Transmission Control Protocol）是一种面向连接的、可靠的传输层协议，用于在网络上可靠地传输数据。TCP属于[[OSI 参考模型|OSI模型]]中的传输层，它提供了一种点对点的、可靠的、字节流的通信机制。TCP确保了数据的可靠性、有序性和流控制，使得在网络上的数据传输更为可靠。

为了在不可靠的**信道**上建立可靠的连接。

以下是TCP的一些主要特点和功能：
## 可靠性：
TCP通过使用确认和重传机制，确保数据在传输过程中不会丢失、损坏或重复。每个传输的数据包都会得到接收方的确认，如果发送方没有收到确认，就会进行重传。
### 确认和重传机制
#### 确认机制（Acknowledgment, ACK）：
   - 在TCP通信中，**接收方**会向**发送方**发送确认（ACK）消息，以通知发送方已成功接收到数据。这是通过TCP头部中的ACK标志来表示的。
   - 确认号字段（Acknowledgment Number）指示了**接收方**期望接收的下一个字节的序号。通过不断更新确认号，接收方可以告知发送方成功接收到哪些字节的数据。
   - TCP使用累计确认，意味着接收方只需确认最后一个按序接收的字节，而不需要单独确认每个字节。
#### 重传机制：
   - 如果发送方在一定时间内未收到接收方的确认，或者接收方通知有丢失的数据，发送方将**重传**未确认的数据。
   - 发送方在每个发送的数据包中都包含一个序号（Sequence Number），用于标识发送的字节。如果接收方收到的数据包有序号问题，它将向发送方发送一个选择性重传请求（Selective Repeat Request）或紧急重传请求（Urgent Repeat Request）。
   - 通过这种机制，TCP确保即使在网络出现延迟、拥塞或数据包丢失的情况下，数据仍然能够可靠地传输。如果发送方未收到确认，它会认为数据包已经丢失，然后重新发送该数据包。
#### 超时和重传：
   - 发送方还会设置一个**定时器**，用于监视发送的数据包是否在合理的时间内得到确认。如果超过了设定的时间，发送方会认为数据包丢失，并触发相应的重传机制。
   - 超时时间的设定需要根据网络的延迟和拥塞情况来调整，以确保及时发现丢失的数据包。
## 有序性：
TCP（传输控制协议）通过序号（Sequence Number）和确认号（Acknowledgment Number）机制来保证数据的有序传输。以下是TCP如何实现有序性的关键步骤：
### 序号和确认号：
   - 在TCP头部中，每个数据包都包含了**序号字段**，用于标识发送方传送的数据的字节流。这个序号表示数据包中第一个字节的序列号。
   - 接收方的确认消息中包含了**确认号字段**，指示接收方期望接收的下一个字节的序列号。通过确认号，接收方通知发送方它已经成功接收了哪些字节的数据。
### 累计确认：
   - TCP使用累计确认的方式，接收方只需确认已经成功接收的**最后一个**按序的字节，而不是逐个确认每个字节。例如，如果接收方已经成功接收了字节1到10，那么确认号将是11，表示期望接收字节11之后的数据。
### 有序的重传：
   - 如果发送方在合理的时间内未收到接收方的确认消息，或者接收方通知有序号问题，发送方将会重传未确认的数据包。这有助于确保接收方能够按照正确的顺序接收数据。
## 流控制：
TCP使用滑动窗口机制进行**流控制**，以确保发送方和接收方之间的数据流量是适度的，防止数据发送速率过快导致接收方无法及时处理。
### 滑动窗口：
- 发送方和接收方各自维护一个**滑动窗口**，窗口的大小表示*能够发送或接收的未确认数据的范围*。
- 滑动窗口的大小可以动态调整，以适应网络和接收方的处理能力。通过滑动窗口，发送方知道接收方的可用接收缓冲区大小，而接收方可以通知发送方其当前处理能力。
## 拥塞控制：
TCP通过拥塞窗口控制机制来避免网络拥塞。它能够根据网络的拥塞情况自适应地调整数据发送速率，以保持网络的稳定性和高效性。
## 面向连接：
在数据传输之前，TCP需要先建立连接，然后再进行数据的传输。连接的建立和关闭都经过一定的握手过程，这确保了通信双方的状态同步。
## 全双工通信：
TCP支持全双工通信，即数据可以双向传输，发送方和接收方可以同时发送和接收数据。
## 字节流传输：
TCP是基于字节流的协议，它不关心应用层发送的数据的单位，而是将数据看作连续的字节流。这有助于提供更大的灵活性。
