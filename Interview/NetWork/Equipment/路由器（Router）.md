路由器是计算机网络中一种关键的网络设备，主要负责在**不同网络**之间传输数据包，并根据目标地址信息进行路由决策。
# 基本特点和功能
## 网络层设备：
- 路由器工作在[[OSI 参考模型#3.网络层（Network Layer）：|网络层]]（第三层）上，负责处理IP数据包，决定数据包的最佳路径进行转发。
## 路由决策：
- 根据目标IP地址和**路由表**，路由器确定数据包应该被发送到网络的哪个部分。路由表包含有关网络拓扑的信息，使路由器能够做出最优的路由选择。
## 连接不同网络：
- 路由器通常用于连接不同的网络，如连接局域网（LAN）到互联网，或连接多个局域网。
## NAT（网络地址转换）：
- 路由器可以执行[[网络地址转换技术（NAT）|网络地址转换]]，允许多个设备在本地网络共享单一公共IP地址。这有助于缓解IPv4地址短缺问题。
## 安全功能：
- 路由器通常具有防火墙功能，可以根据规则过滤和阻止不安全或未经授权的流量。
## 负责分组重组：
- 在不同网络之间传输数据包时，路由器负责将数据包重新组装，确保它们在不同网络之间能够正确传递。
## QoS（服务质量）管理：
- 路由器可以支持服务质量（QoS）管理，允许对网络流量进行优先级排序，以确保对实时应用（如语音和视频）的良好性能。
## 动态路由协议：
- 路由器可以使用动态路由协议（例如OSPF、BGP、RIP）来与其他路由器交换路由信息，以自动适应网络拓扑的变化。
## 虚拟专用网络（VPN）支持：
- 一些路由器支持VPN功能，允许建立安全的远程连接，使用户能够远程访问局域网资源。
# 工作原理
1. **接收数据包：** 路由器首先接收到来自源设备的数据包，这通常发生在路由器的一个接口（端口）上。

2. **查找路由表：** 接收到的数据包包含目标IP地址。路由器内部维护着一个路由表，其中包含了网络地址、下一跳地址（或出接口）和相关的路由度量。路由器根据目标IP地址在路由表中查找匹配的路由表项。

3. **路由决策：** 根据路由表的信息，路由器做出路由决策，确定数据包应该被发送到哪个接口（或下一跳地址）以最有效地到达目标网络。

4. **转发数据包：** 一旦路由决策完成，路由器将数据包转发到选择的接口。这涉及到数据链路层的帧封装，将网络层的数据包封装成适用于物理链路的帧。

5. **数据包传输：** 转发的数据包通过选择的接口进入网络，并在网络中进行传输。这可以是通过有线介质（如以太网）或无线介质（如Wi-Fi）。

6. **目标网络到达：** 数据包通过网络传输，逐步接近目标网络。路由器的作用是确保数据包在网络间正确传递，经过一系列的路由器，直到到达目标网络。

7. **解封装数据包：** 一旦数据包到达目标网络的路由器，路由器将进行帧解封装，将数据包还原成网络层的格式。

8. **交付目标设备：** 最终，目标网络的路由器将数据包交付给目标设备，实现数据的传输。
# 路由表
路由表是路由器内部存储的一个数据结构，用于指导数据包在网络中的转发过程。这个表包含了关于目标网络地址、下一跳地址（或出接口）以及相关的路由度量信息。在路由器收到一个数据包时，它会根据目标IP地址在路由表中查找匹配的路由信息，然后基于这些信息做出路由决策。

每个路由表条目包含以下关键信息：

1. **目标网络地址（Destination Network）：** 指定了数据包要到达的目标网络的IP地址**范围**。通常以网络前缀表示，例如，192.168.1.0/24。

2. **下一跳地址（Next Hop）：** 表示数据包离开当前路由器时，应该转发到的下一个路由器的IP地址或出接口。如果目标网络就在当前路由器所在的网络上，下一跳地址可能是直接连接的目标设备的IP地址。

3. **出接口（Outgoing Interface）：** 指定了数据包离开当前路由器时使用的网络接口。如果下一跳地址是直接连接的，出接口通常是与下一跳直接相连的物理接口。

4. **路由度量（Metric）：** 表示到达目标网络的路径的开销或优先级。不同的路由协议使用不同的度量标准，例如跳数、带宽、延迟等。

路由表是路由器在进行数据包转发时的关键工具，它使路由器能够智能地选择最佳路径将数据包从源到目的地。路由表的内容可以通过手动配置或使用**动态路由协议**来更新和维护。

