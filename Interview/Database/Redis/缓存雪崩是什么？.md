缓存雪崩是指缓存在*同一时间大量失效*或者ekspired,导致大量的请求直接打到数据库上,造成数据库压力骤增甚至宕机的情况。

主要有以下几种场景会导致缓存雪崩:

1. **大量缓存同时过期**
如果缓存服务器上的大量缓存数据集中在同一时间过期时,会产生大量的缓存miss,进而把压力全部转嫁到数据库上。

2. **redis宕机**
如果使用的是redis缓存,一旦redis服务器宕机,所有的查询都会直接踩到数据库上。

3. **缓存总量设置过载导致缓存被清空**
如果缓存服务器上的缓存总量已经超出了预设的最大值,这时会按照LRU(最近最少使用)策略清理缓存,导致原有的热点缓存数据被清除,发生缓存miss。

4. **缓存应用系统重启导致重建缓存**
当缓存应用系统重启时(比如维护)会导致之前的缓存数据被清空,重启后第一批查询请求全部走数据库。

缓存雪崩对应的解决方案有:

1. **缓存数据的过期时间设置随机**
避免大量缓存在同一时间过期。

2. **构建Redis高可用方案**  
使用Redis集群提高可用性。

3. **设置合理的失效时间**
根据业务模型设置合理的缓存失效时间。

4. **实现缓存重建机制**
通过缓存重建机制确保缓存重建期间不会压垮数据库。

5. **提供降级方案**
在缓存雪崩期间提供一些相对低级但可用的方案供用户访问。

总之缓存雪崩是一种极端情况,如果没有做好相关预防措施,很容易造成系统瞬时宕机或雪崩,影响业务。对于重要的生产系统需要进行全方位的缓存雪崩预防设计。