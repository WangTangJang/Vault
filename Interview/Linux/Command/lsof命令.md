**lsof** 命令（list open files）用于列出当前系统打开的文件，包括普通文件、网络连接、管道等。该命令可以显示每个打开文件的进程 ID、文件描述符、文件路径、访问模式等信息。

**命令格式**

```
lsof [选项] [参数]
```

**常用选项**

- `-a`：列出所有打开的文件，包括那些没有进程持有的文件。
- `-c <进程名>`：列出指定进程所打开的文件。
- `-d <文件号>`：列出占用该文件号的进程。
- `+d <目录>`：列出目录下被打开的文件。
- `+D <目录>`：递归列出目录下被打开的文件。
- `-i <条件>`：列出符合条件的进程。(例如：`-i tcp:80` 列出所有占用 80 端口的进程)
- `-n <网络地址>`：列出所有连接到指定网络地址的进程。
- `-p <进程 ID>`：列出指定进程 ID 的进程所打开的文件。
- `-u <用户名>`：列出指定用户所打开的文件。

**输出信息**

lsof 命令的输出信息包含以下列：

- **COMMAND**：进程名
- **PID**：进程 ID
- **USER**：进程所属用户
- **FD**：文件描述符
- **TYPE**：文件类型（例如：REG、DIR、FIFO、CHR、BLK、SOCK）
- **DEVICE**：设备号
- **SIZE/OFF**：文件大小或偏移量
- **NODE NAME**：节点名
- **NAME**：文件名

**示例**

- 列出所有打开的文件：

```
lsof -a
```

- 列出指定进程所打开的文件：

```
lsof -c sshd
```

- 列出占用 80 端口的进程：

```
lsof -i tcp:80
```

- 列出所有连接到 Google 的进程：

```
lsof -i google.com
```

- 列出指定用户所打开的文件：

```
lsof -u root
```

**高级用法**

lsof 命令可以结合其他命令使用，以实现更复杂的功能。例如，可以使用 `grep` 命令过滤输出结果，或使用 `awk` 命令提取特定字段。

**注意事项**

- lsof 命令需要 root 权限才能查看所有打开的文件。
- lsof 命令可能会输出大量信息，建议使用管道或重定向命令将输出结果保存到文件以便查看。

**总结**

lsof 命令是一个功能强大的工具，可以用于查看系统打开的文件信息，以及诊断文件占用等问题。
